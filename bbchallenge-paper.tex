% !TeX root = bbchallenge-paper.tex

\title{Determination of the fifth Busy Beaver value}
\author{
        The bbchallenge Collaboration
}

\documentclass[a4paper,british]{article}

\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[margin=1in]{geometry}
%\usepackage{subfig}
\usepackage[hidelinks]{hyperref}
\usepackage{caption}
\usepackage{floatpag}
\usepackage{subcaption}
\usepackage{tikz}

\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{xcolor,colortbl,tikz}

\usepackage{bold-extra}% bold texttt

\usepackage{graphicx}
\usepackage{mathtools}

\usepackage{booktabs} 

\usepackage{amsmath,amsfonts,amssymb,amsthm}

\theoremstyle{definition} % don't use italics
\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{corollary}{Corollary}[section]
\numberwithin{equation}{section}


\theoremstyle{definition} % emphasize the "Remark N." with italics, not bold
\newtheorem{observation}{Observation}[section]
\newtheorem{example}{Example}[section]
\newtheorem{remark}{Remark}[section]

\usepackage{xassoccnt}
\DeclareCoupledCountersGroup{theorems}
\DeclareCoupledCounters[name=theorems]{theorem,definition,lemma,proposition,corollary,remark,observation,example}

\usepackage{microtype,xspace,wrapfig,multicol} 
\usepackage[textsize=tiny,color=lightgray]{todonotes} 
\usepackage[normalem]{ulem} % sout
\usepackage{stmaryrd}


\newcommand{\ts}[1]{{\color{red}#1}}
\newcommand{\tsi}[1]{\todo[inline]{TS: #1}}
\newcommand{\tsm}[1]{\todo{TS: #1}}
\newcommand{\tss}[2]{{\ts{\sout{#1}}} {\ts{#2}}}
\newcommand{\jb}[1]{{\color{blue}#1}}
\newcommand{\jbi}[1]{\todo[inline]{JB: #1}}
\newcommand{\jbm}[1]{\todo{JB: #1}}
\newcommand{\jbs}[2]{{\jb{\sout{#1}}} {\jb{#2}}}
\newcommand{\tabi}{\hspace{\algorithmicindent}}
\newcommand{\Lim}[1]{\raisebox{0.5ex}{\scalebox{0.8}{$\displaystyle \lim_{#1}\;$}}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}

\newcommand{\lhead}[1]{\stackrel{#1}\triangleleft}
\newcommand{\rhead}[1]{\stackrel{#1}\triangleright}

\newcommand{\tm}[1]{\href{https://bbchallenge.org/#1}{\nolinkurl{#1}}}

\usepackage{xcolor}

\definecolor{colorA}{RGB}{255,0,0}
\definecolor{colorB}{RGB}{255,128,0}
\definecolor{colorC}{RGB}{0,0,255}
\definecolor{colorD}{RGB}{0,255,0}
\definecolor{colorE}{RGB}{255,0,255}

\newcommand{\stateA}{{\textcolor{colorA}{A}}\xspace}
\newcommand{\stateB}{{\textcolor{colorB}{B}}\xspace}
\newcommand{\stateC}{{\textcolor{colorC}{C}}\xspace}
\newcommand{\stateD}{{\textcolor{colorD}{D}}\xspace}
\newcommand{\stateE}{{\textcolor{colorE}{E}}\xspace}

\newcommand{\szero}{\texttt{0}\xspace}
\newcommand{\sone}{\texttt{1}\xspace}

\def\@fnsymbol#1{\ensuremath{\ifcase#1\or *\or \dagger\or \ddagger\or
   \mathsection\or \mathparagraph\or \|\or **\or \dagger\dagger
   \or \ddagger\ddagger \else\@ctrerr\fi}}
\newcommand{\ssymbol}[1]{^{\@fnsymbol{#1}}}

\newcommand{\BBtheFourth}{107}
\newcommand{\SigmaTheFourth}{13}
\newcommand{\BBtheFourthTNF}{858{,}909}

\newcommand{\BBtheFifth}{47{,}176{,}870}
\newcommand{\BBtheFifthTNF}{181{,}385{,}789}
\newcommand{\SigmaTheFifth}{4{,}098}

\newcommand{\BBTxF}{3{,}932{,}974}
\newcommand{\BBTxFTNF}{2{,}154{,}217}

\newcommand{\radofull}{Tibor Rad\'o\xspace}
\newcommand{\rado}{Rad\'o\xspace}

\newcommand{\cryptid}{Cryptid\xspace}

\newcommand{\cycler}{Cycler\xspace}
\newcommand{\cyclers}{Cyclers\xspace}
\newcommand{\TC}{Translated Cycler\xspace}
\newcommand{\TCs}{Translated Cyclers\xspace}

\newcommand{\headpos}{head-position\xspace}
\newcommand{\headposs}{head-positions\xspace}

\newcommand{\states}{\mathcal{S}}
\newcommand{\alphabet}{\mathcal{A}}
\newcommand{\symbolzero}{\texttt{0}}
\newcommand{\symbolone}{\texttt{1}}

\newcommand{\numSporadic}{13\xspace}

\newcommand{\ssp}{state-symbol-pair\xspace}
\newcommand{\ssps}{state-symbol-pairs\xspace}

\newcommand{\HALT}{\texttt{HALT}\xspace}
\newcommand{\NONHALT}{\texttt{NONHALT}\xspace}
\newcommand{\UNKNOWN}{\texttt{UNKNOWN}\xspace}

\newcommand{\CoqBB}{Coq-BB5\xspace}
\newcommand{\CoqBBnospace}{Coq-BB5}

\newcommand{\TMstep}{\to}

\begin{document}
\date{}
\maketitle

\begin{abstract}
    We prove that $S(5) = 47,176,870$ using the Coq proof assistant. The Busy Beaver value $S(n)$ is the maximum~number of steps a halting n-state 2-symbol Turing machine can perform from the all-0 tape before halting and $S$ was historically introduced by \radofull in 1962 as one of the simplest examples of a noncomputable function.  The proof enumerates 181,385,789 Turing machines with 5 states, and, for each machine, decides whether it halts or not.
    Our result marks the first determination of a new Busy Beaver value in over 40 years and the first Busy Beaver value to ever be formally verified, demonstrating the effectiveness of collaborative online research (\url{bbchallenge.org}).
\end{abstract}


\setcounter{tocdepth}{2}
\tableofcontents

\paragraph{The bbchallenge Collaboration (credits).} The following contributions resulted in the determination of the fifth Busy Beaver value: mxdys (\CoqBB, Loops, RepWL); Nathan Fenner, Georgi Georgiev a.k.a~Skelet, savask (NGramCPS); Justin Blanchard, Mateusz Naściszewski, Konrad Deka (FAR); Iijil (WFAR); mei (\texttt{busycoq}); Shawn Ligocki, Jason Yuen, mei (Sporadic Machines ``Shift Overflow Counters''); Shawn Ligocki, Pavel Kropitz, mei (Sporadic Machine ``Skelet \#1''); Chris Xu, mxdys (Sporadic Machine ``Skelet \#17''); Shawn Ligocki, Dan Briggs, mei (Sporadic Machine ``Skelet \#10''); Justin Blanchard, mei (Sporadic Machines ``Finned Machines''); Yannick Forster (Coq review); Tristan Stérin (bbchallenge.org).
\newpage

\begin{center}

\end{center}



\begin{figure}
    \begin{quote}
        ``In any case, even though skilled mathematicians and experienced programmers attempted to evaluate $\Sigma(3)$ and S(3), there is no evidence that any known approach will yield the answer, even if we avail ourselves of high-speed computers and elaborate programs. As regards $\Sigma(4)$, $S(4)$ the situation seems to be entirely hopeless at present.'' --- \radofull, 1963 \cite{Rado_1963}
    \end{quote}
    \begin{quote}
        ``\textit{Prediction 5}. It will never be proved that $\Sigma(5) = \SigmaTheFifth$ and $S(5) = \BBtheFifth$.'' --- Allen H. Brady, 1990 \cite{BradyMeaningOfLife}
    \end{quote}
    \caption{\radofull, who invented the Busy Beaver game, proved the value of $S(2)$ in 1962 \cite{Rado_1962}, and was involved in the proof of $S(3)$ in 1963 \cite{Lin1963}, did not believe that $S(4)$ could be solved at his time. Allen H. Brady, who proved the value of $S(4)$ in 1983 \cite{Brady83}, did not believe that $S(5)$ could be solved at all. Amusingly, Brady opens his article on $S(4)$ with \rado's above quote \cite{Brady83}. Under that light, the knowledge of a (small) Busy Beaver value seems to be a reflection of the computing technology available at the time it was proved.}
\end{figure}

\vspace{-40pt}

\section{Introduction}

\subsection{Main Results}\label{sec:intro:mainresults}

\newcommand{\noncomput}{noncomputable\xspace}
\newcommand{\BBfull}{Busy Beaver\xspace}
\newcommand{\Coq}{Coq\xspace}
% We'll update this link to v1 release URL
\newcommand{\CoqProofReleaseURL}{\url{https://github.com/ccz181078/Coq-BB5}}

\newcommand{\ie}{i.e.~}
\newcommand{\eg}{e.g.~}

Are there simple \noncomput functions? What is the \textit{smallest} open problem in mathematics? What do algorithms look like, \textit{in the wild}?

Introduced by \radofull in 1962, \textit{the \BBfull game} gives a framework to answer these seemingly independent questions, starting with the first one since \rado's goal was to ``present some very simple instances of \noncomput functions'' \cite{Rado_1962}. The game is as such: (i) run all $n$-state Turing machines\footnote{See Section~\ref{sec:TMs} for Turing machines definitions and examples.} from the all-zero tape (ii) consider the set of machines that eventually halt (iii) the winner of the game is the halting machine that has the most \sone symbols on its tape when it halts. This maximum number of \sone symbols on halting tape among $n$-state machines is called $\Sigma(n)$. \rado also introduced $S(n)$, the maximum number of steps made by a halting $n$-state Turing machine from all-zero tape. Both functions $\Sigma$ and $S$ are \noncomput! This is most obvious in the case of $S$: if an $n$-state machine runs for more than $S(n)+1$ steps, we know it will never halt, giving an algorithm to decide Turing's halting problem if $S$ was computable. This tight link between $S$ and the halting problem makes it more interesting and practical to us than $\Sigma$, hence we take the liberty to concentrate more on $S$.

%This tight link to the halting problem makes $S$ more interesting and practical to us than $\Sigma$, hence we take the liberty (similarly to other authors \cite{BusyBeaverFrontier,otherexamples?}) to focus the busy beaver game on $S$ instead of $\Sigma$ and to call the $n$-state \textit{busy beaver winner} the machine achieving $S(n)$ running steps. 
While there is no algorithm to compute $S(n)$ for \textit{all} $n$ we can certainly try to compute $S(n)$ for \textit{some} $n$. Prior to this work, only the four first values of $S$ had been proved: $S(1)=1$, $S(2)=6$ \cite{Rado_1962}, $S(3) = 21$ \cite{Lin1963}, $S(4) = 107$ \cite{Brady83}. With some early attempts in the 1960s and 1970s, the $S(5)$ quest seriously started in 1983 with a 2-day competition organised at the University of Dortmund\footnote{Report of the competition: \url{https://docs.bbchallenge.org/other/lud20.pdf}.} with the sole goal of finding new 5-state champions -- \ie 5-state machines achieving better $S$ scores than any machines previously known \cite{PMichel_website,michel2019busy}. The winning machine in Dortmund achieved $134,467$ steps, establishing $S(5) \geq 134,467$. In 1989, a big step was made when Marxen and Buntrock found a new champion achieving $\BBtheFifth$ steps \cite{Marxen_1990}, showing $S(5) \geq \BBtheFifth$; this machine is given in Figure~\ref{fig:bb5}. However, it remained unknown if no other machine could beat it, \ie whether Marxen and Buntrock's machine was the actual 5-state Busy Beaver winner or not. In 2020, Aaronson conjectured that there was no better 5-state machine, \ie $S(5) = \BBtheFifth$ \cite{BusyBeaverFrontier}.

Our main result is to prove this conjecture, using the \Coq proof assistant \cite{the_coq_development_team_2024_14542673}, see Theorem~\ref{th:BB5}. The winning machine for $S(5)$ is also the winning machine for $\Sigma(5)$. We also prove $\Sigma(5) = \SigmaTheFifth$, see Theorem~\ref{th:BB5Sigma}.

\begin{theorem}\label{th:BB5}
    $S(5) = \BBtheFifth$.
\end{theorem}

The function $S$ can naturally be extended to Turing machines using more than two alphabet symbols \cite{BradyMeaningOfLife}, like, for instance, $S(2,3) = 38$ is the value of $S$ for 2-state, 3-symbol machines \cite{BradyMeaningOfLife, MICHEL200445, LafittePapazian2007}. We prove, using Coq, that $S(2,4) = \BBTxF$, see Theorem~\ref{th:BB2x4} and Figure~\ref{fig:bb2x4}:

\begin{theorem}\label{th:BB2x4}
    $S(2,4) = \BBTxF$.
\end{theorem}

The Coq proofs for $S(5)$ and $S(2,4)$ --- as well as for previously known $S(2),\,S(3),\,S(4)$ and $S(2,3)$ --- are available at \url{https://github.com/ccz181078/Coq-BB5}. The lists of all the Turing machines evaluated by these proofs are available at \url{https://docs.bbchallenge.org/CoqBB5_release_v1.0.0/}.

The goal of this paper is to present these proofs. As a result of our work, we now have a clearer view of the landscape of small Busy Beaver values, see Table~\ref{table:landscape}.


\setlength{\fboxrule}{1.2pt}
\begin{table}[h]
    \centering
    \small
    \renewcommand{\arraystretch}{1.3}
    \setlength{\tabcolsep}{5pt}  % Adjust column spacing
    \begin{tabular}{c|ccccc}
        \hline
        \textbf{Symbols} & \textbf{2-State}                                                           & \textbf{3-State} & \textbf{4-State} & \textbf{5-State} & \textbf{6-State} \\
        \hline
        2                & \cellcolor{green!20}$S(2) = 6$ \cite{Rado_1962}
                         & \cellcolor{green!20}$S(3) = 21$ \cite{Lin1963}
                         & \cellcolor{green!20}$S(4) = 107$ \cite{Brady83}
                         & \cellcolor{green!50}{$S(5) = \BBtheFifth$}
                         & \cellcolor{orange!50}{$S(6) > 10 \uparrow \uparrow 15$}                                                                                                \\
        \hline
        3                & \cellcolor{green!20}$S(2,3) = 38$ \cite{LafittePapazian2007}
                         & \cellcolor{orange!50}{$S(3,3) > 10^{17}$}
                         & \cellcolor{orange!20}$S(4,3) > 2 \uparrow \uparrow \uparrow 2^{2^{{32}}} $
                         & --                                                                         & --                                                                        \\
        \hline
        4                & \cellcolor{green!50}{$S(2,4) = \BBTxF$}
                         & \cellcolor{orange!20}$S(3,4) > 2 \uparrow^{15} 5 $
                         & --                                                                         & --               & --                                                     \\
        \hline
        5                & \cellcolor{orange!50}{$S(2,5) > 10 \uparrow \uparrow 4$}
                         & --                                                                         & --               & --               & --                                  \\
        \hline
    \end{tabular}
    \caption{Landscape of small busy beaver values.
        \cellcolor{green!20}Cells highlighted in green correspond to values for which we provide \Coq proofs. Bright green indicates the new results, $S(5)$ and $S(2,4)$, original to this work.
        Cells highlighted in orange indicate the existence of a Cryptid (\ie machines whose halting problem is currently open and believed to be mathematically hard), see Appendix~\ref{app:cryptids}. Lighter orange means that the existence of a Cryptid comes trivially from reusing a known 3-state 3-symbol Cryptid and ignoring the available additional state or symbol. }
    \label{table:landscape}
\end{table}











\paragraph{Challenges.} Proving $S(5) = \BBtheFifth$ required analyzing the behavior of $\BBtheFifthTNF$ Turing machines\footnote{This exact number can only be known after the proof is done, see Section~\ref{sec:enum}.}-- evidently requiring computer assistance. The challenge for a halting machine is the case where it halts after a number of steps that is too enormous to be simulated step-by-step (e.g. the current 6-state champion halts after $10 \uparrow \uparrow 15$ steps \cite{Pavel_discorvery}, see Appendix~\ref{app:lowerbounds}), this challenge was not met for 5-state machines since they halt in at most $\BBtheFifth$ steps -- this could not have been known for certain in advance but was believed -- which is easy to simulate on modern computers. The challenge for a non-halting machine is that proving it does not halt can be hard. How hard?

Dauntingly, any $\Pi_1^0$ mathematical statement\footnote{A $\Pi_1^0$ statement is a statement of first-order logic of the form ``$\forall x, \phi(x)$'' where $\phi$ is a sentence with only bounded quantifiers (\ie $\phi(x)$ can always be verified by a computer in finite time).} can be encoded as the halting problem of a Turing machine (from all-zero tape). Such statements are common and include famous open problems in mathematics such as Goldbach's conjecture or the Riemann hypothesis. Goldbach's conjecture, formulated in 1742, is one of the oldest open problems in mathematics and states ``every even positive integer greater than 2 is the sum of two prime numbers.'' We can build a Turing machine that halts iff the conjecture is false: by enumerating all positive integers, then for each, test all sums of smaller primes and halt iff we do not find the sum. A (formally verified) machine performing this procedure has been built using only 25 states \cite{GoldbachTM27, GoldbachTM25}. This means that proving the value of $S(25)$ is at least as hard as solving Goldbach's conjecture because the proof of $S(25)$ must contain an argument as of why this particular 25-state machine does not (or, believed less likely, does) halt. Similarly, the Riemann hypothesis has been encoded in a 744-state machine \cite{RiemannTM,Yedidia2016,BusyBeaverFrontier}. As low as 15 states is enough to encode a hard number theoretical conjecture by Erd\H{o}s \cite{BB15}. Worst, the consistency of common axioms sets such as Peano's Arithmetic (PA) or Zermelo–Fraenkel set theory (ZF) is also $\Pi_1^0$ since one can enumerate proofs in these systems until the proof of a contradiction is found. This has been done for ZF, using 748 states \cite{ZFTM,Yedidia2016,BusyBeaverFrontier,BB748Thesis}. By G\"odel's second incompleteness theorem, this means that proving the value of $S(748)$ cannot be done using ZF. Aaronson conjectures that as low as $S(20)$ cannot be proven in ZF and as low as $S(10)$ cannot be proven in PA \cite{BusyBeaverFrontier}.

Hence, while 5-state halting machines were not feared, it remained unknown how hard non-halting 5-state machines could get. This article settles the question: the smallest open problem in mathematics (on the Busy Beaver scale) does not arise from 5-state machines -- but we have good contenders for 6-state machines, see Section~\ref{sec:cryptids}.

\paragraph{Related Work.} The proof of $S(4) = \BBtheFourth$ was published in 1983 \cite{Brady83}. One of its main innovations was the introduction of a method to solve the halting problem of a category of machines the author calls \textit{XMas Trees}. A caveat of \cite{Brady83} resides in the following quote from the paper: ``All of the remaining holdouts were examined by means of voluminous printouts of their histories along with some program extracted features. It was determined to the author's satisfaction that none of these machines will ever stop.'' A \textit{holdout} is a machine still needing a proof of halting/nonhalting. Using Coq, we bring additional confirmation that $S(4) = \BBtheFourth$, see Theorem~\ref{th:BB4}.

\newcommand{\SkeletHoldoutsSporadic}{\ts{XX}\xspace}

We know of two attempts at solving $S(5)$: in 2003, Georgi Georgiev (also known under pseudonym ``Skelet'' or ``Skeleta'') published the program \texttt{bbfind} \cite{Skelet_bbfind} which enumerates and decides the halting behavior of 5-state Turing machines, claiming to leave unsolved mainly 43 holdouts\footnote{\url{https://skelet.ludost.net/bb/nreg.html} and \url{https://bbchallenge.org/skelet}}. Attesting to the validity of the result is difficult as Skelet's code consists of ca. 6000 lines of uncommented and undocumented Pascal. That said, it turned out to be instrumental for our result as, after reverse engineering parts of it, we were able to learn and improve on his ``Closed Position Set'' technique (see Section~\ref{sec:n-gramCPS}) which improvements decided slightly more than 99.87\% of the 5-state Turing machines excluding loops (see Section~\ref{sec:loops}). All of our \numSporadic \textit{Sporadic Machines}, \ie machines for which we needed individual proofs of nonhalting, were either among Skelet's 43 holdouts or claimed to have been manually solved by him. See Section~\ref{sec:sporadic} for more discussion on our analyses of these longstanding holdouts. Some of Skelet's list of 43 holdouts were analysed by hand prior to our work \cite{DanBriggs}. The second known attempt at $S(5)$ was in 2008 with Hertel's ``Symbolic induction prover'', which claimed to leave only $1{,}000$ holdouts, $900$ of which were manually proven not to halt, allegedly leaving only $100$ proper holdouts \cite{Hertel}. In an opposite way to Skelet's work, the method is documented but, to the best of our knowledge, no code is made available, nor are the 900 claimed manual proofs, making verification of the result difficult apart from reproduction from scratch (arguably, verification would still be tedious if the 900 proofs were given).

The \BBfull problem was also studied in other models of computation than \rado's (c.f. Section~\ref{sec:TMs}), including the \textit{quadruple} variation of Turing machines where each transition may move or write a new symbol, but not both \cite{Ross2003,Ross2005}. For additional historical perspective on the \BBfull problem, we refer the reader to Michel's survey and website \cite{michel2019busy,PMichel_website}.

\paragraph{Structure of the proof: overview.} Machines are enumerated arborescently in \textit{Tree Normal Form} (TNF) \cite{Brady64} which drastically reduces the search space's size -- \eg from ca. 10 trillion machines to $\BBtheFifthTNF$ for 5-state machines, see Section~\ref{sec:enum}.

Each enumerated machine is fed through a sequence (or \textit{pipeline}) of \textit{deciders}, where a decider is an algorithm trying to decide whether the machine halts or not. Because of the noncomputability of the halting problem, there is no \textit{universal} decider but all the craft resides in creating deciders able to decide large families of machines, in reasonable time. The $S(5)$ pipeline of deciders is given in Table~\ref{tab:pipelineBB5} -- see Tab~\ref{tab:pipelineBB2x4} for $S(2,4)$. Deciders are presented in Section~\ref{sec:deciders}. To the best of our knowledge, all the deciders we present are original.

In the case of 5-state machines, \numSporadic \textit{Sporadic Machines} were not solved by deciders and required individual proofs of nonhalting, see Section~\ref{sec:sporadic}. These machines include suprising behaviours, such as eventually-repeating chaos (machine ``Skelet \#1''), base-Fibonacci counters (machine ``Skelet \#10''), or obfuscated Gray code (machine ``Skelet \#17'', \cite{xu2024skelet17fifthbusy}) and they are beautiful examples of \textit{algorithms in the wild}: non-human-engineered algorithms that, like deep sea life, were only found by means of exploration.

\paragraph{Collaboratively solving the problem: bbchallenge.org.} In 2022, Stérin created ``The Busy Beaver Challenge'', \url{bbchallenge.org}, an online platform dedicated to collaboratively solving ``$S(5)=\BBtheFifth$'' \cite{sterin_2022_14955828}. Collaboration was motivated by the great amount of Turing machines to study in order to solve the problem. The bbchallenge platform essentially consists of the website, an instant chat server\footnote{\url{https://discord.gg/3uqtPJA9Uv}}, and, a wiki\footnote{\url{wiki.bbchallenge.org}}. The website serves as an entry-point to the problem and was providing a browsable \textit{seed database}\footnote{\url{https://github.com/bbchallenge/bbchallenge-seed}} containing a set of 5-state Turing machines to prove nonhalting in order to solve $S(5)$. Using this database, the task of contributors was to design deciders (see above). For both the seed database and deciders, trust in the results required a strict validation process: (i) any algorithm had to be reproduced at least once by an independent contributor, with matching results, (ii) a proof of correctness had to be provided (in natural language, like a regular mathematical article). Over the span of two years, collaborators organically joined the project and contributed to deciders naturally, where their skills and interests applied the most, without any vertical research management structure. Most of the collaboration and interactions happened asynchronously on our (rather entropic) instant chat server, which, at the time of this writing has about 800 members and 20 active daily.  Some core members of the project are anonymous. Most members do not work in academia (or are undergraduate students). The community seems to be relatively balanced between America, Europe and Asia. With the surprise release of \CoqBB in the spring of 2024 (see below), both the seed database and the validation process were made obsolete, but almost all the collaborative work performed on \url{bbchallenge.org} during these 2 years was embedded in the Coq proof. In Section~\ref{sec:intro:discuss}, we discuss bbchallenge in relation to other collaborative research projects.
% \begin{itemize}
%     \item The website serves as an entry-point to the problem with, in particular, the ability to browse the space of Turing machines, visualise them, and access them individually by URL. The website was also tracking the remaining number of undecided 5-state Turing machines.
%     \item The instant chat server is the main communication tool, it played an instrumental role in many collaborative discoveries that were either made or announced there. The style of this chat is rather entropic with no limitations on members to talk about whichever scientific topic they want. At the time of this writing the chat server has about 800 members and about 20 active daily.
%     \item The GitHub organisation contains the official repositories of the project (\eg website, this paper, deciders, etc...).
%     \item The wiki allows for long-term conservation of knowledge.
%     \item The forum is used for slower-paced style of conversations and official announcements. The forum is quite inactive.
% \end{itemize}


\paragraph{\Coq and \CoqBB.} To the best of our knowledge, our work is the first to formally verify a \BBfull value. Our proof, \CoqBB, is written in Coq\footnote{Now renamed Rocq.} \cite{the_coq_development_team_2024_14542673} which is an interactive theorem prover and programming language based on the Calculus of Inductive Constructions \cite{CoC} whose development started in 1989. Famous results proven in \Coq include the four color theorem on coloring maps \cite{fourColour, fourColourCoq}, Feit-Thompson theorem on odd orders finite groups \cite{feitThompson} and Kepler's conjecture on packing spheres \cite{flyspeck}. Distinctively, \CoqBB's objects of study are computer programs (Turing machines) instead of more traditional mathematical objects. \CoqBB is available at \url{https://github.com/ccz181078/Coq-BB5}.

\CoqBB works by implementing both the TNF enumeration and the deciders (see proof structure above) directly in Coq, proving them correct, running them and finally using the algorithms' outputs together with the individual proofs for Sporadic Machines to get the result. For instance, proving that a decider is correct amounts to proving that when the decider outputs that a Turing machine halts/does not halt, the machine actually halts/does not halt. Proofs such as \CoqBB, which rely on computing algorithmic outputs \cite{vmcompute,nativecompute}, are known as ``proofs by reflection'' \cite{boutin1997} and the \Coq proof of the four color theorem also fits in that category \cite{fourColourCoq}.

In our case, with hundreds of millions of Turing machines to study, the use of \Coq immensely facilitates scientific consensus on the correctness of the proof: for instance, we are assured that we did not omit any necessary Turing machine in our study. Also, the 13 individual proofs for Sporadic Machines contain some lengthy and technical arguments that would be quite hard to verify and trust if not formalised -- \eg a standalone article was dedicated to machine ``Skelet \#17'' \cite{xu2024skelet17fifthbusy} and its \Coq proof is about 10,000 lines long.

This totalistic use of \Coq in order to solve $S(5)$, where the TNF enumeration of the $\BBtheFifthTNF$ Turing machines itself is implemented and ran in \Coq, came as a surprise when \CoqBB was released in the spring of 2024 by contributor ``mxdys'' who embedded two years of work made by the bbchallenge collaboration as well as improving and introducing new deciders to finish the proof. Indeed, consensus within the bbchallenge collaboration before \CoqBB was that formally verifying the TNF enumeration was too arduous and too computationally intensive to be implemented within a proof assistant; at best, the belief was that formal verification efforts would rely on an external, trusted enumeration, such as bbchallenge's seed database (see above). \CoqBB relies on a previous formalisation, \texttt{busycoq} \cite{busycoq}, for 12 of the 13 Sporadic Machines \Coq proofs. \CoqBB initially compiled in about 13 hours on a standard laptop but the use of \Coq's faster computing engine, \texttt{native\_compute} \cite{nativecompute} and paralelisation of the proof (see Section~\ref{sec:enum}) brought compile time down to about 45 minutes on 13 cores.

Trusting that \Coq itself is correct, the only elements to check in order to trust \CoqBB's results are the main theorem statement and the definitions it uses, which have been isolated in an individual file, \texttt{BB5\_Statement.v}, which is documented with comments, only 121 lines long, and that does not require \Coq expertise to be read. Independent \Coq experts have reviewed and validated it; they also ruled out the possibility that the proof would try to exploit a potential \Coq bug to falsely claim the results. Finally, after compilation, the proof prints the only axiom that it uses, called \texttt{functional\_extensionality\_dep} from \Coq's standard library, which claims that two functions are equal if they are equal in all points.

% Maybe some of this will go in discussion, also, Dafny?


\newpage
\subsection{Discussion}\label{sec:intro:discuss}

% massively online collab is young

\subsection{Future Work}

\newpage
\section{Turing machines}\label{sec:TMs}

\vspace{-22pt}
\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \renewcommand{\arraystretch}{1.3} % Increase row height
        \setlength{\tabcolsep}{12pt} % Increase column spacing
        \vspace{10pt} % Adjust vertical alignment
        \begin{tabular}{ccc}
            \toprule
                    & \textbf{0} & \textbf{1} \\
            \midrule
            \stateA & 1R\stateB  & 1L\stateC  \\
            \stateB & 1R\stateC  & 1R\stateB  \\
            \stateC & 1R\stateD  & 0L\stateE  \\
            \stateD & 1L\stateA  & 1L\stateD  \\
            \stateE & ---        & 0L\stateA  \\
            \bottomrule
        \end{tabular}
        \caption{Transition table of the 5-state 2-symbol \BBfull winner. This machine was discovered by Marxen and Buntrock in 1989 \cite{Marxen_1990}.}
        \label{table:bb5}

        \vspace{10pt} % Adjust spacing
        \includegraphics[width=0.7\linewidth]{figures/space-time-diagrams/bb5_20k.png} % Adjust the path as needed
        \caption{20,000-step \textit{zoomed out} space-time diagram of the 5-state winner.}\label{fig:bb5-diagram-zoomout}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \vspace{10pt} % Adjust vertical alignment
        \includegraphics[width=0.7\linewidth]{figures/space-time-diagrams/bb5.pdf}
        \caption{Space-time diagram of the first 45 steps of the 5-state winner.}
        \label{fig:bb5-diagram}
    \end{subfigure}
    \caption{Transition table and space-time diagrams of the 5-state 2-symbol busy beaver winner, which halts after 47,176,870 steps.
        \url{https://bbchallenge.org/1RB1LC_1RC1RB_1RD0LE_1LA1LD_---0LA}.}
    \label{fig:bb5}
\end{figure}


We consider Turing machines that use a single, discrete, bi-infinite tape -- \ie the tape can be thought of a function $t: \mathbb{Z} \to \alphabet$ with $\alphabet$ the alphabet of symbols used by the machine. Machine transitions are either undefined (the machine halts if it ever reaches an undefined transition) or given by (a) a symbol of $\alphabet$ to write (b) a direction to move (right or left) and (c) a state to go to -- \ie the transition table of a Turing machine is a partially defined function $\delta: \text{States} \times \alphabet \to \alphabet \times \{\text{L},\text{R}\} \times \text{States}$. Figure~(\ref{table:bb5}) gives the transition table of the 5-state 2-symbol \BBfull winner. The machine halts after 47,176,870 steps (starting from all-0 tape) when it reads a \szero in state \stateE (undefined transition). Allowing for undefined transitions is a small, consequenceless but useful (see Section~\ref{sec:enum}), deviation from \rado's original setup.

In the \BBfull context, machines are always executed from the all-0 tape and starting in state \stateA. Execution goes as follows: at each step, the machine which is in state $s$ looks at which symbol $\sigma$ is present on the tape cell the head is currently on and then, if defined, executes the instruction given by its transition table, \eg $\delta(s, \sigma) = 0\text{L}\text{\stateE}$ means that the machine will write a \szero, move the cell on the left of the current one and switch to state \stateE. If $\delta(s, \sigma)$ is not defined, the machine halts.



A \textit{configuration} (also known as \textit{execution state}) of a Turing machine is defined by the 3-tuple: (i) state (ii) position of the head on the tape (iii) content of the memory tape. As mentioned above, here, \textit{the initial configuration} of a machine is always (i) state is A, i.e. the first state to appear in the machine's description (ii) head's position is 0 (iii) the initial tape is all-0 -- i.e. each memory cell is containing 0. We write $c_1 \TMstep_\mathcal{M} c_2$ if a configuration $c_2$ is obtained from $c_1$ in one computation step of machine $\mathcal{M}$. We omit $\mathcal{M}$ if it is clear from context. We let $c_1 \TMstep^s c_2$ denote a sequence of $s$ computation steps, and let $c_1 \TMstep^* c_2$ denote zero or more computation steps. % exact same wording as in https://dna.hamilton.ie/assets/dw/NearyWoodsFCT09.pdf
We write $c_1 \TMstep \bot$ if the machine halts after executing one computation step from configuration $c_1$. Halting happens when an undefined machine transition is met i.e. no instruction is given for when the machine is in the state, tape position and tape corresponding to configuration $c_1$.

% When discussing concrete configurations, we write
% $0^\infty\; s_1\; \cdots\; s_{k-1}\; [s_k]_q\; s_{k+1}\; \cdots\; s_n\; 0^\infty$
% to mean the configuration where the machine is in state $q$, with the head
% positioned on the symbol $s_k$, and the tape both starts and end by an infinite sequence of 0s, represented $0^\infty$. Thus, the initial configuration of the machine
% can be written as $0^\infty\; [0]_A\; 0^\infty$.

% \paragraph*{Directional Turing machines.} We will sometimes prefer to think of the tape head as being between
% symbols. Thus, we write $l \lhead{q} r$, with $l,r\in\{0,1\}^*$ to mean that the head is at the rightmost symbol
% of $l$, and $l \rhead{q} r$ to mean that the head is at the leftmost symbol of $r$.
% For example, $0^\infty\; [1]_A\; 0^\infty$ can be written as
% $0^\infty\; 1 \lhead A 0^\infty$ or $0^\infty \rhead A 1\; 0^\infty$.


\paragraph*{Space-time diagrams.} We use space-time diagrams to give a visual representation of the behavior of a given machine. The space-time diagram of machine $\mathcal{M}$ is an image where the $i^\text{th}$ row of the image gives:
\begin{enumerate}
    \item The content of the tape after $i$ steps (for 2-symbol machines, black is 0 and white is 1, while for $n$ symbols, black is 0, white is symbol $n-1$ and linear gray-scaling is used in between).
    \item The position of the head is colored to give state information using the following colours for 5-state machines: \textcolor{colorA}{A},  \textcolor{colorB}{B},  \textcolor{colorC}{C},  \textcolor{colorD}{D},  \textcolor{colorE}{E} (you have to look at the row above to deduce what symbol is the head reading, unless it is the initial row, where a \szero is read).
\end{enumerate}

Figure~(\ref{fig:bb5-diagram}) gives a 45-step space-time diagram for the 5-state 2-symbol \BBfull winner. We often use \textit{zoomed-out} space-time diagrams without state-coloring information, such as Figure~(\ref{fig:bb5-diagram-zoomout}) which gives the 20,000 first steps of the 5-state 2-symbol \BBfull winner.


\paragraph*{Turing machine format.} We often communicate Turing machines using the following linear format: \\ \texttt{1RB1LC\_1RC1RB\_1RD0LE\_1LA1LD\_---0LA} represents the transition table of Figure~\ref{table:bb5} where \texttt{\_} is used to separate states and transitions are given in read-symbol order. Note that, historically, the undefined transition reached by a halting machine was represented using \texttt{1RZ}, hence our format allows to use any letter outside of the state space to represent halting, \eg \texttt{1RB1LC\_1RC1RB\_1RD0LE\_1LA1LD\_1RZ0LA}. Multi-symbols machines are represented in the same way, \eg the 2-state 4-symbol \BBfull winner is \texttt{1RB2LA1RA1RA\_1LB1LA3RB---} (also given by \texttt{1RB2LA1RA1RA\_1LB1LA3RB1RZ}), see Figure~\ref{fig:bb2x4}.

This format can be used as URL for the \url{bbchallenge.org} website, \eg \url{https://bbchallenge.org/1RB1LC\_1RC1RB\_1RD0LE\_1LA1LD\_1RZ0LA} will display the transition table, space-time diagrams and known information about the machine.

\begin{figure}[h!]
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \renewcommand{\arraystretch}{1.3} % Increase row height
        \setlength{\tabcolsep}{12pt} % Increase column spacing
        \vspace{10pt} % Adjust vertical alignment
        \begin{tabular}{cccccc}
            \toprule
                    & \textbf{0} & \textbf{1} & \textbf{2} & \textbf{3} \\
            \midrule
            \stateA & 1R\stateB  & 2L\stateA  & 1R\stateA  & 1R\stateA  \\
            \stateB & 1L\stateB  & 1L\stateA  & 3R\stateB  & ---        \\
            \bottomrule
        \end{tabular}
        \caption{Transition table of the 2-state 4-symbol \BBfull winner found by Ligocki and Ligocki in 2005 \cite{PMichel_website}.}
        \label{table:bb2x4}

        \vspace{10pt} % Adjust spacing
        \includegraphics[width=0.7\linewidth]{figures/space-time-diagrams/bb2x4_20k.png} % Adjust the path as needed
        \caption{20,000-step \textit{zoomed out} space-time diagram of the 2-state 4-symbol winner.}\label{fig:bb2x4-diagram-zoomout}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \vspace{10pt} % Adjust vertical alignment
        \includegraphics[width=0.7\linewidth]{figures/space-time-diagrams/bb5.pdf}
        \caption{Space-time diagram of the first 45 steps of the 2-state 4-symbol winner.}
        \label{fig:bb2x4-diagram}
    \end{subfigure}
    \caption{Transition table and space-time diagrams of the 2-state 4-symbol \BBfull winner, which halts after $\BBTxF$ steps.
        \url{https://bbchallenge.org/https://bbchallenge.org/1RB2LA1RA1RA_1LB1LA3RB---}.}
    \label{fig:bb2x4}
\end{figure}

\newpage
\section{Enumerating Turing machines in Tree Normal Form (TNF)}\label{sec:enum}

\newpage
\section{Deciders}\label{sec:deciders}

A \textit{decider} is a program that takes as input a Turing machine $\mathcal{M}$ and that returns either \HALT, \NONHALT, \UNKNOWN whether it was able to detect that the machine's halting status (halt or nonhalt) or not.

\input{sections/decider-pipelines.tex}



\input{sections/decider-0-loops.tex}
% \input{sections/decider-1-translated-cyclers.tex}
\input{sections/decider-2-NGramCPS.tex}
\newpage
\input{sections/decider-3-RepWL.tex}
\input{sections/decider-4-FAR.tex}
\input{sections/decider-5-MITM-WFAR.tex}

\newpage
\section{Sporadic 5-state machines}\label{sec:sporadic}

\newpage
\section{Results}\label{sec:sporadic}

\newpage
\section{Zoology}\label{sec:sporadic}


\bibliographystyle{abbrv}
\newpage
\bibliography{bbchallenge-paper}

\appendix


\section{Busy Beavers lower bounds}\label{app:lowerbounds}
\section{Exact pipelines}\label{app:pipelines}
\section{Cryptids}\label{app:cryptids}

\end{document}
